#!/bin/bash

TARGET_FILE="/home/server/home/user.txt"
BACKUP_DIR="/home/server/home/backup_DIR"

mkdir -p"$BACKUP_DIR"

TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
BACKUP_FILE+"$BACKUP_DIR/backup_$TIMESTAMP.txt"

if ! cms -s "$TARGET_FILE" "$BACKUP_DIR/lastest.txt"; then
   cp "$TARGET_FILE" "$BACKUP_FILE"
   cp "$TARGET_FILE" "$BACKUP_DIR/latest.txt"
   echo "$(date):File changed. Backed up to $BACKUP_FILE">>"$BACKUP_DIR/change_log.txt"
else
   echo "$(date):No changes detected.">>"$BACKUP_DIR/change_log.txt"
fi